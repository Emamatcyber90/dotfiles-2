---
- name: Full desktop provision
  hosts: all
  tasks:
    - name: ensure private key and public one are present
      copy: 
        src: "{{ secret }}/{{ item }}"
        dest: "/home/{{ target_user }}/.ssh/{{ item }}" 
        mode: 0600
      with_items:
        - id_rsa.pub
        - id_rsa

    - name: Register 
      command: git --git-dir="{{ ansible_env.HOME }}/.dotfiles.git" init
      args:
        chdir: "{{ ansible_env.HOME }}"
